# Gib Hemani
# Replication of epistatic signals

################
# REQUIREMENTS #
################

- R64 2.15.1
- snpStats (Bioconductor library)
- Running in Mac/Linux


########
# DATA #
########

1. Genotypes in binary plink format, they will be matched by RS SNP ID to our list. Please ensure that individual IDs are all unique.

2. Expression phenotypes should be adjusted for any fixed effects / covariates. The phenotype should be normalised (e.g. rank transformation, a function for this exists in the R/GenABEL). Please use the following format for the expression phenotype data:

FID IID ILMN_xxxx ILMN_xxxx ILMN_xxxx ...
f1  i1  x         x         x         ...
f2  i2  x         x         x         ...
f3  i3  x         x         x         ...
.
.
.

3. "SNP_pairs.RData" file that we will send to you. This contains the top hits from our study.


#########################
# How to use the script #
#########################

Run the following command:

cd tests
R --no-save --args /path/to/plink /path/to/binary_plink_data /path/to/probe_data.txt /path/to/interaction_list.RData < replication.R

It will do the following things:

1. Extract all the required SNPs from binary plink file
2. Read in all the probes requierd and rank transform them to normality
4. For each significant pair in our dataset it will test for interactions in your dataset
5. Save the results in a file called "replication.RData"


